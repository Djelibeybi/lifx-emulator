import{au as c,av as l,aw as i,w as t,ax as _}from"./DfIkQq0Y.js";const f={uptime_seconds:0,start_time:0,device_count:0,packets_received:0,packets_sent:0,packets_received_by_type:{},packets_sent_by_type:{},error_count:0,activity_enabled:!1};function w(){let e=c(l({...f}));return{get value(){return t(e)},set(r){i(e,r,!0)},reset(){i(e,{...f},!0)}}}const P=w();function h(){let e=c(l(new Map));return{get map(){return t(e)},get list(){return[...t(e).values()]},get count(){return t(e).size},get(r){return t(e).get(r)},set(r){const s=new Map;for(const n of r)s.set(n.serial,n);i(e,s,!0)},add(r){i(e,new Map(t(e)),!0),t(e).set(r.serial,r)},remove(r){i(e,new Map(t(e)),!0),t(e).delete(r)},update(r,s){const n=t(e).get(r);n&&(i(e,new Map(t(e)),!0),t(e).set(r,{...n,...s}))},clear(){i(e,new Map,!0)}}}const D=h();function E(){let e=c(l([]));return{get list(){return t(e)},get count(){return t(e).length},set(r){i(e,r.slice(-100),!0)},add(r){i(e,[...t(e),r].slice(-100),!0)},clear(){i(e,[],!0)},get reversed(){return[...t(e)].reverse()}}}const K=E();function b(){let e=c(l({global:null,devices:{},types:{},locations:{},groups:{}}));return{get global(){return t(e).global},get devices(){return t(e).devices},get types(){return t(e).types},get locations(){return t(e).locations},get groups(){return t(e).groups},setGlobal(r){t(e).global=r},setDevice(r,s){if(s===null){const{[r]:n,...a}=t(e).devices;t(e).devices=a}else t(e).devices={...t(e).devices,[r]:s}},setType(r,s){if(s===null){const{[r]:n,...a}=t(e).types;t(e).types=a}else t(e).types={...t(e).types,[r]:s}},setLocation(r,s){if(s===null){const{[r]:n,...a}=t(e).locations;t(e).locations=a}else t(e).locations={...t(e).locations,[r]:s}},setGroup(r,s){if(s===null){const{[r]:n,...a}=t(e).groups;t(e).groups=a}else t(e).groups={...t(e).groups,[r]:s}},setAll(r){i(e,{global:r.global??null,devices:r.devices??{},types:r.types??{},locations:r.locations??{},groups:r.groups??{}},!0)},handleChange(r){switch(r.scope){case"global":t(e).global=r.config;break;case"device":if(r.identifier)if(r.config===null){const{[r.identifier]:s,...n}=t(e).devices;t(e).devices=n}else t(e).devices={...t(e).devices,[r.identifier]:r.config};break;case"type":if(r.identifier)if(r.config===null){const{[r.identifier]:s,...n}=t(e).types;t(e).types=n}else t(e).types={...t(e).types,[r.identifier]:r.config};break;case"location":if(r.identifier)if(r.config===null){const{[r.identifier]:s,...n}=t(e).locations;t(e).locations=n}else t(e).locations={...t(e).locations,[r.identifier]:r.config};break;case"group":if(r.identifier)if(r.config===null){const{[r.identifier]:s,...n}=t(e).groups;t(e).groups=n}else t(e).groups={...t(e).groups,[r.identifier]:r.config};break}}}}const R=b(),g="lifx-emulator-view",p="lifx-emulator-page-size",S="lifx-emulator-expanded",m="lifx-emulator-tab",y="lifx-emulator-show-stats";function x(){return typeof localStorage>"u"?"card":localStorage.getItem(g)==="table"?"table":"card"}function T(){if(typeof localStorage>"u")return 20;const e=localStorage.getItem(p),r=e?parseInt(e,10):20;return[10,20,50,100].includes(r)?r:20}function k(){if(typeof localStorage>"u")return{zones:new Set,metadata:new Set};try{const e=localStorage.getItem(S);if(!e)return{zones:new Set,metadata:new Set};const r=JSON.parse(e);return{zones:new Set(r.zones||[]),metadata:new Set(r.metadata||[])}}catch{return{zones:new Set,metadata:new Set}}}function z(){if(typeof localStorage>"u")return"devices";const e=localStorage.getItem(m);return e==="activity"||e==="scenarios"?e:"devices"}function A(){return typeof localStorage>"u"?!1:localStorage.getItem(y)==="true"}function I(){let e=c(l(x())),r=c(l(T())),s=c(1),n=c(l(k())),a=c(l(z())),u=c(l(A()));function d(){typeof localStorage<"u"&&localStorage.setItem(S,JSON.stringify({zones:[...t(n).zones],metadata:[...t(n).metadata]}))}return{get viewMode(){return t(e)},get pageSize(){return t(r)},get currentPage(){return t(s)},get expanded(){return t(n)},get activeTab(){return t(a)},get showStats(){return t(u)},setViewMode(o){i(e,o,!0),typeof localStorage<"u"&&localStorage.setItem(g,o)},setPageSize(o){i(r,o,!0),i(s,1),typeof localStorage<"u"&&localStorage.setItem(p,String(o))},setCurrentPage(o){i(s,o,!0)},setActiveTab(o){i(a,o,!0),typeof localStorage<"u"&&localStorage.setItem(m,o)},toggleShowStats(){i(u,!t(u)),typeof localStorage<"u"&&localStorage.setItem(y,String(t(u)))},toggleZonesExpanded(o){t(n).zones.has(o)?t(n).zones.delete(o):t(n).zones.add(o),i(n,{...t(n)},!0),d()},toggleMetadataExpanded(o){t(n).metadata.has(o)?t(n).metadata.delete(o):t(n).metadata.add(o),i(n,{...t(n)},!0),d()},isZonesExpanded(o){return t(n).zones.has(o)},isMetadataExpanded(o){return t(n).metadata.has(o)}}}const Y=I(),v="lifx-emulator-theme";function M(){if(typeof localStorage>"u")return"system";const e=localStorage.getItem(v);return e==="light"||e==="dark"||e==="system"?e:"system"}function G(){let e=c(l(M())),r=c(l(typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!0));const s=_(()=>t(e)==="system"?t(r)?"dark":"light":t(e));function n(){typeof document<"u"&&document.documentElement.setAttribute("data-theme",t(s))}return typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a=>{i(r,a.matches,!0)}),{get mode(){return t(e)},get effective(){return t(s)},applyTheme:n,set(a){i(e,a,!0),typeof localStorage<"u"&&localStorage.setItem(v,a),n()},toggle(){const a=t(e)==="light"?"dark":t(e)==="dark"?"system":"light";this.set(a)}}}const L=G();export{K as a,P as b,D as d,R as s,L as t,Y as u};
