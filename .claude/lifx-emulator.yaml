# LIFX Emulator Configuration File
# ================================
#
# This file configures the lifx-emulator CLI. Place it in one of:
#   1. Path specified via --config flag
#   2. Path in LIFX_EMULATOR_CONFIG environment variable
#   3. lifx-emulator.yaml or lifx-emulator.yml in the current directory (auto-detected)
#
# CLI parameters override values in this file.
# All settings are optional - defaults are used for missing values.

# ==============================================================================
# Server Options
# ==============================================================================

# IP address to bind to (default: 127.0.0.1)
# Use 0.0.0.0 to listen on all interfaces
bind: 127.0.0.1

# UDP port for LIFX protocol (default: 56700)
port: 56700

# Enable verbose logging to show all packet traffic (default: false)
verbose: true

# ==============================================================================
# Storage & Persistence (DEPRECATED)
# ==============================================================================
#
# DEPRECATED: --persistent and --persistent-scenarios are deprecated and will
# be removed in a future release. Use config file device definitions instead.
#
# To migrate existing persistent storage to a config file:
#   lifx-emulator export-config --output my-config.yaml
#
# See docs/cli/configuration.md for details on config file device definitions.

# Persist device state across restarts (default: false)
# DEPRECATED: Use device definitions with state fields instead
# persistent: false

# Persist scenario configurations across restarts (default: false)
# DEPRECATED: Use the scenarios section in the config file instead
# persistent_scenarios: false

# ==============================================================================
# HTTP API Server
# ==============================================================================

# Enable HTTP API server for monitoring and management (default: false)
api: true

# API server bind address (default: 127.0.0.1)
api_host: 127.0.0.1

# API server port (default: 8080)
api_port: 8080

# Enable activity logging in the API - last 100 packets (default: true)
# Disable to reduce traffic and save UI space
api_activity: true

# ==============================================================================
# Device Creation by Product ID
# ==============================================================================

# Create devices by specific product ID from the LIFX registry.
# Run 'lifx-emulator list-products' to see all available products.
# No devices are created by default. Use products or device type counts.
#
# Common product IDs:
#   27 - LIFX A19 (color bulb)
#   29 - LIFX A19 Night Vision (infrared)
#   32 - LIFX Z (multizone strip, requires firmware upgrade for extended)
#   38 - LIFX Beam (multizone, native extended support)
#   50 - LIFX Mini White to Warm (color temperature)
#   55 - LIFX Tile (matrix device)
#   70 - LIFX Switch (relay, no lighting)
#   90 - LIFX Clean (HEV)
#  117 - LIFX Z US (multizone, native extended support)

products:
- 27
- 38
- 55

# products:
#   - 27
#   - 38
#   - 55

# ==============================================================================
# Device Creation by Type
# ==============================================================================

# Number of color lights - LIFX A19 (default: 0)
color: 0

# Number of color temperature lights - LIFX Mini White to Warm (default: 0)
color_temperature: 0

# Number of infrared lights - LIFX A19 Night Vision (default: 0)
infrared: 0

# Number of HEV/Clean lights - LIFX Clean (default: 0)
hev: 0

# Number of multizone devices - strips/beams (default: 0)
multizone: 0

# Number of tile devices - LIFX Tile (default: 0)
tile: 0

# Number of LIFX Switch devices - relay-based, no lighting (default: 0)
switch: 0

# ==============================================================================
# Multizone Options
# ==============================================================================

# Number of zones per multizone device (default: uses product defaults)
# LIFX Z default: 16 zones, LIFX Beam default: 80 zones
multizone_zones: 80

# Enable extended multizone support (default: true)
# true: Creates LIFX Beam with firmware 3.70
# false: Creates LIFX Z with firmware 2.60
multizone_extended: true

# ==============================================================================
# Tile/Matrix Options
# ==============================================================================

# Number of tiles per tile device (default: uses product defaults)
# LIFX Tile default: 5 tiles
# tile_count: 1

# Width of each tile in zones (default: uses product defaults)
# LIFX Tile default: 8
# tile_width: 8

# Height of each tile in zones (default: uses product defaults)
# LIFX Tile default: 8
# tile_height: 8

# ==============================================================================
# Serial Number Options
# ==============================================================================

# Serial prefix - 6 hex characters (default: d073d5)
serial_prefix: d073d5

# Starting serial suffix (default: 1)
# Serials are formatted as: <prefix><suffix as 6-digit hex>
# Example: d073d5000001, d073d5000002, ...
serial_start: 1
# ==============================================================================
# Per-Device Definitions
# ==============================================================================

# Define individual devices with specific configurations.
# Each device requires a product_id; other fields are optional.
#
# Available fields:
#   product_id:           Required - LIFX product ID from registry
#   serial:               Optional - 12-char hex serial (e.g. "d073d5000001")
#   label:                Optional - Device label (max 32 characters)
#   power_level:          Optional - Initial power (0 = off, 65535 = on)
#   color:                Optional - Initial HSBK color (dict or [h, s, b, k] list)
#   location:             Optional - Location label (UUID auto-generated)
#   group:                Optional - Group label (UUID auto-generated)
#   zone_count:           Optional - Number of zones (multizone devices only)
#   zone_colors:          Optional - Per-zone HSBK colors (multizone devices only)
#   infrared_brightness:  Optional - Initial IR brightness 0-65535 (IR devices only)
#   hev_cycle_duration:   Optional - HEV cycle duration in seconds (HEV devices only)
#   hev_indication:       Optional - HEV indication enabled (HEV devices only)
#   tile_count:           Optional - Number of tiles (matrix devices only)
#   tile_width:           Optional - Tile width in zones (matrix devices only)
#   tile_height:          Optional - Tile height in zones (matrix devices only)

# devices:
#   # Color bulb with full initial state
#   - product_id: 27
#     serial: d073d5000001
#     label: "Living Room"
#     power_level: 65535
#     color:
#       hue: 21845
#       saturation: 65535
#       brightness: 65535
#       kelvin: 3500
#     location: "Downstairs"
#     group: "Lights"
#
#   # Color bulb using compact HSBK notation
#   - product_id: 27
#     label: "Kitchen"
#     color: [0, 0, 32768, 4000]
#     location: "Downstairs"
#     group: "Lights"
#
#   # Multizone strip with per-zone colors
#   - product_id: 38
#     serial: d073d5000002
#     label: "TV Backlight"
#     zone_count: 16
#     zone_colors:
#       - [0, 65535, 65535, 3500]       # Red
#       - [5461, 65535, 65535, 3500]     # Orange
#       - [10922, 65535, 65535, 3500]    # Yellow
#       - [21845, 65535, 65535, 3500]    # Green
#       - [32768, 65535, 65535, 3500]    # Cyan
#       - [43690, 65535, 65535, 3500]    # Blue
#       - [49151, 65535, 65535, 3500]    # Indigo
#       - [54613, 65535, 65535, 3500]    # Violet
#     location: "Downstairs"
#     group: "Entertainment"
#
#   # Infrared light with IR brightness
#   - product_id: 29
#     label: "Security Camera"
#     infrared_brightness: 32768
#
#   # HEV/Clean light with cycle config
#   - product_id: 90
#     label: "Bathroom"
#     hev_cycle_duration: 7200
#     hev_indication: true
#
#   # Tile device
#   - product_id: 55
#     tile_count: 3
#     label: "Art Display"
#
#   # LIFX Switch (relay device)
#   - product_id: 70
#     label: "Garage Switch"

# ==============================================================================
# Scenarios
# ==============================================================================
#
# Configure test scenarios for simulating protocol edge cases.
# Scenarios can be set at 5 scope levels (precedence: device > type >
# location > group > global).
#
# Available scenario fields:
#   drop_packets:         Dict of packet_type -> drop rate (0.0-1.0)
#   response_delays:      Dict of packet_type -> delay in seconds
#   malformed_packets:    List of packet types to corrupt
#   invalid_field_values: List of packet types to send with 0xFF bytes
#   firmware_version:     Override firmware as [major, minor]
#   partial_responses:    List of packet types for incomplete responses
#   send_unhandled:       Boolean to send StateUnhandled for unknown packets

# scenarios:
#   # Global settings apply to all devices
#   global:
#     send_unhandled: true
#
#   # Per-device scenarios (by serial)
#   devices:
#     d073d5000001:
#       drop_packets:
#         101: 0.5          # Drop 50% of GetColor responses
#       response_delays:
#         116: 0.2          # 200ms delay on GetPower responses
#
#   # Per-type scenarios (color, multizone, matrix, hev, infrared)
#   types:
#     multizone:
#       response_delays:
#         506: 0.1          # 100ms delay on StateMultiZone
#
#   # Per-location scenarios
#   locations:
#     Downstairs:
#       drop_packets:
#         101: 0.1          # 10% packet loss for all downstairs devices
#
#   # Per-group scenarios
#   groups:
#     Entertainment:
#       malformed_packets:
#         - 506             # Corrupt StateMultiZone for entertainment group

# ==============================================================================
# Example Configurations
# ==============================================================================

# --- Minimal Setup ---
# One color light on localhost:56700
# color: 1

# --- Development Setup ---
# verbose: true
# api: true
# color: 2
# multizone: 1

# --- Stateful Testing Lab ---
# Replaces the deprecated --persistent workflow. Define devices with
# their desired initial state directly in the config file.
# api: true
# color: 0
# devices:
#   - product_id: 27
#     serial: d073d5000001
#     label: "Test Bulb 1"
#     power_level: 65535
#     color: [21845, 65535, 65535, 3500]
#     location: "Lab"
#     group: "Test Lights"
#   - product_id: 27
#     serial: d073d5000002
#     label: "Test Bulb 2"
#     location: "Lab"
#     group: "Test Lights"
#   - product_id: 38
#     serial: d073d5000003
#     zone_count: 80
#     label: "Test Beam"
#   - product_id: 55
#     serial: d073d5000004
#     tile_count: 5
#     label: "Test Tiles"

# --- CI/CD Pipeline ---
# bind: 127.0.0.1
# port: 56701
# verbose: false
# api: false
# color: 1
# multizone: 1
# serial_prefix: "cafe00"
